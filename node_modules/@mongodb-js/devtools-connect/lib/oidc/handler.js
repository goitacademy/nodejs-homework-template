"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.oidcServerRequestHandler = void 0;
const static_pages_1 = require("./static/static-pages");
function oidcServerRequestHandler(options, info) {
    const { productDocsLink, productName } = options;
    const { res, result, status } = info;
    res.statusCode = status;
    res.setHeader('Content-Security-Policy', "default-src 'self'; style-src 'unsafe-inline'");
    res.setHeader('Content-Type', 'text/html; charset=utf-8');
    switch (result) {
        case 'accepted':
            res.end((0, static_pages_1.OIDCAcceptedPage)({ productDocsLink, productName }));
            break;
        case 'rejected':
            res.end((0, static_pages_1.OIDCErrorPage)({ productDocsLink, productName, ...info }));
            break;
        default:
            res.end((0, static_pages_1.OIDCNotFoundPage)({ productDocsLink, productName }));
            break;
    }
}
exports.oidcServerRequestHandler = oidcServerRequestHandler;
//# sourceMappingURL=handler.js.map